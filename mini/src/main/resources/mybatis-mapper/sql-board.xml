<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.mini.mapper.BoardMapper">
	<select id="selectBoardList" parameterType="hashmap" resultType="com.example.mini.model.Board">
		SELECT
			BOARDNO,
			BOARDKIND,
			KEYWORDTYPE,
			B.USERID AS USERID, 
			U_NAME AS NAME,
			B.CDATETIME AS CDATETIME,
			B.UDATETIME AS UDATETIME,
			TITLE,
			VIEWCNT,
			REPLYYN,
			DELYN
		FROM mini_db2.T1_BOARD B
		INNER JOIN mini_db2.T1_USER U ON B.USERID = U.USERID
		WHERE BOARDKIND = #{boardKind} AND DELYN = 'N'
		<if test="keywordType != '' and keywordType != null">
				AND KEYWORDTYPE = #{keywordType}
		</if>
		<if test='boardKind == 2 and AccountStatus != "S"'>
				AND U.USERID = #{userId}
		</if>
		ORDER BY CDATETIME DESC
	</select>
	<select id="readBoard" parameterType="hashmap" resultType="com.example.mini.model.Board">
		SELECT
			BOARDNO,
			TITLE,
	    	B.USERID,
	    	U_NAME AS NAME,
	    	CONTENT,
	    	VIEWCNT,
	    	REPLYYN,
	    	BOARDKIND,
	    	B.CDATETIME AS CDATETIME,
	    	B.UDATETIME AS UDATETIME
	    FROM mini_db2.T1_BOARD B
		INNER JOIN mini_db2.T1_USER U ON B.USERID = U.USERID
		WHERE BOARDNO = #{boardNo}
	</select>
	<update id="updateViewCnt" parameterType="hashmap">
		UPDATE mini_db2.T1_BOARD
		SET
			VIEWCNT = VIEWCNT+1
		WHERE BOARDNO = #{boardNo}	
	</update>
	<insert id="insertBoard">
	INSERT INTO mini_db2.T1_BOARD
	VALUE (NULL, #{boardKind},#{keywordType},#{userId}, NOW(), NULL,#{title},#{content},0,'N','N')
	</insert>
	<insert id="insertBoardImg">
	INSERT INTO mini_db2.T1_BRDIMG
	VALUE (NULL, #{boardNo},#{replyNo},#{imgSrc},#{imgName}, #{orgName}, #{imgType})
	</insert>
	<!-- <insert id="insertUser" parameterType="hashmap">
		INSERT INTO T_USER
			(USERID, PASSWORD, U_NAME, PARTNER, GENDER, U_ADDRESS, U_PHONE, 
			U_EMAIL, BIRTH, WEDDINGDAY, CDATETIME, UDATETIME, SATATUS, BANK, BANKACCOUNT)
		VALUES 맵으로 받기 때문에 #{}로 가져온다. jsp에서 정의한 이름으로 가져와야 함.
			(#{userId}, #{pwd}, #{uName}, #{partner}, #{gender}, #{address}, #{phoneNumber},
			#{emailAddr}, #{birthday}, #{weddingday}, SYSDATE, '', 'U', #{bank}, #{bankaccount} )
	</insert> -->
	
</mapper>